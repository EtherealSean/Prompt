<!DOCTYPE html>
<html>
<head>
    <title>Prompts</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
    </style>
</head>
<body>

    <div style="display: flex;">
        <div style="flex: 30%;">
            <h2>Public Goods Game Settings</h2>
            <p>Some settings are fixed for displaying.</p>
            <p>Number of Players: 5</p>
            <p>Number of Rounds: 10</p>
            <p>Number of Liars: 1</p>
            <p>Ratio of Public Goods: 2</p>
            
            <label for="obs_mode">Observability Mode:</label><br>
            <select id="obs_mode" name="obs_mode">
                <option value="partial">Partial (Two neighbors)</option>
                <option value="full">Full</option>
                <option value="0">Non</option>
            </select><br>
            
            <label for="com_mode">Communication Mode:</label><br>
            <select id="com_mode" name="com_mode">
                <option value="partial">Partial (Two neighbors)</option>
                <option value="full">Full</option>
            </select><br>
                
            <label for="if liars are informed">If Liars are Informed that others know there are liars:</label><br>
            <select id="if liars are informed" name="if liars are informed">
                <option value="yes">Yes</option>
                <option value="no">No</option>
            </select><br>

            <label for="if others are informed">If Others are Informed that there are liars</label><br>
            <select id="if others are informed" name="if others are informed">
                <option value="yes">Yes</option>
                <option value="no">No</option>
            </select><br>
            
            <label for="com_cot">Include Thoughts in Dialogue History:</label><br>
            <input type="checkbox" id="com_cot" name="com_cot"><br>
            
            <label for="reputation">Use Reputation System:</label><br>
            <input type="checkbox" id="reputation" name="reputation"><br>
            
            <button onclick="updatePGG()">Update Prompts</button>

            <h3>Other Settings</h3>
            <p>These settings will not change the prompts.</p>

            <label for="models">Model:</label><br>
            <select id="models" name="models">
                <option value="gpt-4-turbo">gpt-4-turbo</option>
                <option value="gpt-4o">gpt-4o</option>
                <option value="gpt-35-turbo">gpt-35-turbo</option>
                <option value="llama3">llama3</option>
            </select><br>

            <label for="shuffle_speaker">Shuffle Speaker Order:</label><br>
            <input type="checkbox" id="shuffle_speaker" name="shuffle_speaker"><br>

            <label for="com_times">Communication Times per Round:</label><br>
            <input type="number" id="com_times" name="com_times" value="1"><br>

            <label for="token_initialization">Token Allocation:</label><br>
            <select id="token_initialization" name="token_initialization">
                <option value="fixed">Fixed</option>
                <option value="random">Random</option>
            </select><br>

            <label for="reset">Reset Tokens Each Round:</label><br>
            <input type="checkbox" id="reset" name="reset"><br>
            
            <label for="memory">Memory:</label><br>
            <input type="number" id="memory" name="memory" value="2"><br>
            
            <p>If Randomly Allocating Tokens:</p>
            <label for="rand_min">Minimum Number of Tokens:</label><br>
            <input type="number" id="rand_min" name="rand_min" value="11"><br>
            
            <p>If Adopting Reputation (Use a rater to rank players' reputation)</p>
            <label for="rater_model">Rater Model:</label><br>
            <select id="rater_model" name="rater_model">
                <option value="gpt-4-turbo">gpt-4-turbo</option>
                <option value="gpt-4o">gpt-4o</option>
                <option value="gpt-35-turbo">gpt-35-turbo</option>
                <option value="llama3">llama3</option>
            </select><br>
            
            <label for="rater_memory">Rater Memory:</label><br>
            <input type="number" id="rater_memory" name="rater_memory" value="3"><br>
        </div>

        <div style="flex: 70%;">
            <h3>System</h3>
            <p id="System"></p>
            <h3>Communication</h3>
            <p id="Comm"></p>
            <h3>Action</h3>
            <p id="Action"></p>
        </div>
    </div>
    
    <script>
        function updatePGG() {
            var obs_mode = document.getElementById('obs_mode').value;
            var com_mode = document.getElementById('com_mode').value;
            var if_liars_are_informed = document.getElementById('if liars are informed').value;
            var if_others_are_informed = document.getElementById('if others are informed').value;
            var com_cot = document.getElementById('com_cot').checked;
            var reputation = document.getElementById('reputation').checked;
            // <h3>Prompts for Liars</h3>;
            // <h4>System</h4>;
            document.getElementById('System').innerText = "You are player_4.";
            document.getElementById('System').innerText += "\n(Liars):\n";
            if (if_liars_are_informed == "yes") {
                document.getElementById('System').innerText += "Actually, you are a liar to tell lies to gain more benefits by free rides, but others know that there is a liar so you have to hide yourself. You need to encourage others to contribute more while telling lies to cover up your lower contributions. Your goal is to take as much free ride as you can.";
            } else {
                document.getElementById('System').innerText += "Actually, you are a liar to tell lies to gain more benefits by free rides. You need to encourage others to contribute more while telling lies to cover up your lower contributions. Your goal is to take as much free ride as you can.";
            }
            document.getElementById('System').innerText += "\n(Others):\n";
            if (if_others_are_informed == "yes") {
                document.getElementById('System').innerText += "Actually, there is a liar so you have to be careful of others' messages. She may tell lies to mislead other players to contribute more so that she can take a free ride. Once the liar is found, do not trust her and notify others.";
            } else {
                document.getElementById('System').innerText += "";
            }
            document.getElementById('System').innerText += "\n\nYou are participating in a game played by 5 players over 10 rounds. You can see the contribution results of";
            if (obs_mode == "full") {
                document.getElementById('System').innerText += " all players.";
            } else if (obs_mode == "partial") {
                document.getElementById('System').innerText += " part of players.";
            } else {
                document.getElementById('System').innerText += " none of players.";
            }
            if (com_mode == "full") {
                document.getElementById('System').innerText += " You can communicate with all players.\n";
            } else if (com_mode == "partial") {
                document.getElementById('System').innerText += " You can communicate with part of players.\n";
            } else {
                document.getElementById('System').innerText += " You cannot communicate with any player.\n";
            }
            document.getElementById('System').innerText += "\nGame Rules:\n" + 
                "1. In each round, you, as a player, must decide how many of your private tokens you wish to contribute secretly to the public pot.\n" +
                "2. The total tokens in this pot will be multiplied by the factor 2 to create the 'public good' payoff.\n" +
                "3. This payoff will then be evenly divided among all players, regardless of their individual contribution.\n" +
                "4. Any tokens you do not contribute will be retained in your private collection.\n" +
                "5. Current tokens you have can be only seen by you, so do other players.\n";
            // <h4>Communication</h4>;
            document.getElementById('Comm').innerText = "Now the talk time of round 2 starts. You have 20 tokens now. Please generate a list of short messages to send to one or some of ";
            if (com_mode == "full") {
                document.getElementById('Comm').innerText += " [player_1, player_2, player_3, player_4] in order to have the highest token count when the game concludes. You can choose not to speak to anyone if there is enough information. If you want to send the message to everyone, the 'receiver' field should be ['everyone']." +
                    "\n\nDialogue history:\nLast 1 rounds and the current round:\n\nRound 1:\n" + 
                    "player_0 to everyone:\n" +
                    "...\n";
                if (com_cot) {
                    document.getElementById('Comm').innerText += "Your thoughts when communication in Round 1:\n";
                }
                    document.getElementById('Comm').innerText += "You to everyone:\n" +
                    "\nRound 2:\n" + "player_1 to You:\n";
            } else if (com_mode == "partial") {
                document.getElementById('Comm').innerText += " [player_0, player_3] in order to have the highest token count when the game concludes. As each player can only observe her own neighbors' contributions, it may be good to chat with others to get more contribution information out of the observation range. You can choose not to speak to anyone if there is enough information." +
                "\n\nDialogue history:\nLast 1 rounds and the current round:\n\nRound 1:\n" +
                "player_0 to You:\n" +
                "player_3 to You:\n";
                if (com_cot) {
                    document.getElementById('Comm').innerText += "Your thoughts when communication in Round 1:\n";
                }
                document.getElementById('Comm').innerText += "You to player_3:\n" +
                "You to player_0:\n" +
                "\nRound 2:\n" +
                "player_0 to You:\n" +
                "player_3 to You:\n";
            }
            if (obs_mode == "full") {
                document.getElementById('Comm').innerText += "\nAction history:\n" + "Last 1 rounds:\n" +
                    "Your thoughts when action in Round 1: \n\nGame Results for Round 1:" +
                    "\nContributed tokens of each player: {'player_0': 7, 'player_1': 5, 'player_2': 5, 'player_3': 5, 'player_4': 3}\n" +
                    "You contributed:3\n" +
                    "Tokens in the public pot: 25\n" +
                    "Your gain: 7.0\n" +
                    "Your tokens after round 1: 27.0\n" +
                    "End of Game Results for Round 1\n";
            } else if (obs_mode == "partial") {
                document.getElementById('Comm').innerText += "\nAction history:\n" + "Last 1 rounds:\n" + 
                    "Your thoughts when action in Round 1:\nGame Results for Round 1:" +
                    "\nContributed tokens of each player: {'player_3': 3, 'player_0': 10}\n" +
                    "You contributed:5\n" +
                    "Tokens in the public pot: 33\n" +
                    "Your gain: 8.2\n" +
                    "Your tokens after round 1: 28.2\n" +
                    "End of Game Results for Round 1\n";
            } else {
                document.getElementById('Comm').innerText += "\nAction history:\n" + "Last 1 rounds:\n" + 
                    "Your thoughts when action in Round 1:\nGame Results for Round 1:" +
                    "\nContributed tokens of each player: {}\n" +
                    "Tokens in the public pot: 42\n" +
                    "You contributed:4\n" +
                    "Your gain: 12.8\n" +
                    "Your tokens after round 1: 32.8\n" +
                    "End of Game Results for Round 1\n";
            }
            if (reputation) {
                document.getElementById('Comm').innerText += "\nReputation history:\nRound 1: ['player_1', 'player_3', 'player_0', 'player_2', 'player_4']\nIn the last round, your rank is 5. Note that there is an independent rater outside the players who ranks all players' reputation in the descending order, based on your communication and contribution. You should try to maintain a good reputation when pursuing more tokens.\n";
            }
            document.getElementById('Comm').innerText += "\nResponse format:\n" +
                "{'thoughts' : 'thoughts content', # think about the necessity of sending a message, as there are costs to send messages.\n" +
                "'receiver' : list of receiver's name,\n" +
                "'message' : list of message contents for each receiver # if the messages are the same for all receivers, you can just send one message.}";
            document.getElementById('Comm').innerText += "\nPlease use double quotes for the keys and values.\n\nNote: If there is no new information, you do not need to send a message, please fill in 'receiver' and 'message' as a string 'None'. You do not have to be too polite so that we can save communication costs. ";
            if (reputation) {
                document.getElementById('Comm').innerText += "You should try to maintain a good reputation when pursuing more tokens. So pay attention to what you say and what you contribute."
            }
            document.getElementById('Comm').innerText += "\n(Liars):\n";
            if (if_liars_are_informed) {
                document.getElementById('Comm').innerText += "You need to encourage others to contribute more while telling lies to cover up your lower contributions, as others know there is a liar."
            } else {
                document.getElementById('Comm').innerText += "You need to encourage others to contribute more while telling lies to cover up your lower contributions."
            }
            document.getElementById('Comm').innerText += "\n(Others):\n";
            if (if_others_are_informed) {
                document.getElementById('Comm').innerText += "You need to communicate to maximize your tokens and find out the liar to avoid free rides."
            } else {
                document.getElementById('Comm').innerText += "You need to communicate to maximize your tokens."
            }
            // <h4>Action</h4>;
            document.getElementById('Action').innerText = "Now round 2 starts." +
                "Your goal is to maximize your total token count by the end of the game. Currently you have 20 tokens. You need to decide the number of tokens to be contributed to the public pot.\n" +
                "\nDialogue history: ..." +
                "\nAction history: ...";
                if (reputation) {
                    document.getElementById('Action').innerText += "\nReputation history: ...";
                }
                document.getElementById('Action').innerText += "\n\nLet\'s think step by step. Please provide your thinking process and the number of tokens in the following JSON format: {'thoughts': 'thinking_process', 'tokens_contributed': 'integer_between_0_and_20'}. Please use double quotes for the keys and values.";
                if (reputation) {
                    document.getElementById('Action').innerText += " You should try to maintain a good reputation when pursuing more tokens. So pay attention to what you say and what you contribute.";
                }
        }
    </script>
</body>
</html>